import{r as m,K as E,L as F,d as S,a as h,M as O,q as j,n as c,N as B,c as p,e as v,j as x,w as g,g as i,h as w,O as z,l as K,P as L,s as C,p as Q,m as W,_ as I,Q as H,b as J,f as P,t as q,R as X}from"./index.202406102048.js";import{i as Y}from"./validate.202406102048.js";function Z(e){return m({url:"/verification/mail/check",method:"post",data:e})}function ee(e){return m({url:"/verification/mail/get",method:"get",params:e})}function te(e){return m({url:"/verification/pic/check",method:"post",data:e})}function oe(e){return`${E()}/verification/pic/get?${F.stringify(e)}`}function ne(e){return m({url:"/verification/sms/check",method:"post",data:e})}function se(e){return m({url:"/verification/sms/get",method:"get",params:e})}function ce(e){return m({url:"/verification/sms/get-by-token",method:"get",params:e})}const V={verificationMailCheck:Z,verificationMailGet:ee,verificationPicCheck:te,verificationPicGet:oe,verificationSmsCheck:ne,verificationSmsGet:se,verificationSmsGetByToken:ce},ae=e=>(Q("data-v-1703c5fe"),e=e(),W(),e),ie={class:"captcha-container"},re=ae(()=>i("div",{class:"captcha-header van-hairline--bottom"},"请完成安全验证",-1)),le={class:"captcha-body"},ue={class:"captcha-code"},pe=["src"],de={class:"captcha-footer"},_e={name:"Captcha"},me=S({..._e,props:{show:{type:Boolean,default:!1}},emits:["confirm","update:show"],setup(e,{expose:t,emit:s}){const a=e,o=s,y={width:"80%","border-radius":"4px"},d=h(""),_=h(""),n=h(""),r=O(150),f=j(()=>c(n).length);function l(){k()}const k=L(()=>{const u=`${Date.now()}`;d.value=u,n.value="",_.value=V.verificationPicGet({key:u})},3e3);function G(){if(!c(n)){C("请输入图形验证码");return}o("confirm",{requestId:c(d),code:c(n)})}B(()=>a.show,u=>{u&&l()});function N(){b(!0)}function $(){b(!1)}function b(u){o("update:show",u)}return t({open:N,close:$,updateShow:b}),(u,T)=>{const M=p("van-icon"),U=p("van-field"),A=p("van-button"),D=p("van-popup");return v(),x(D,{show:e.show,position:"center",teleport:"body",style:y,"onUpdate:show":b},{default:g(()=>[i("div",{class:"captcha-popup-close",onClick:$},[w(M,{class:"captcha-popup-close-icon",name:"cross"})]),i("div",ie,[re,i("div",le,[i("div",ue,[w(U,{modelValue:n.value,"onUpdate:modelValue":T[0]||(T[0]=R=>n.value=R),clearable:"",border:!1,placeholder:"输入验证码",class:"captcha-field",type:"text",focus:""},null,8,["modelValue"]),i("img",{class:"captcha-img",style:z([{width:c(r)+"px",background:"#eee"}]),src:_.value,onClick:l},null,12,pe)]),i("div",{class:"tips",onClick:l},"看不清，换一张"),i("div",de,[w(A,{class:"captcha-btn",block:"",disabled:!f.value,type:"primary",onClick:G},{default:g(()=>[K(" 确认发送 ")]),_:1},8,["disabled"])])])])]),_:1},8,["show"])}}});const fe=I(me,[["__scopeId","data-v-1703c5fe"]]);function he(){let e=null;const t=h(0);function s(o=0){t.value=o,e=setInterval(()=>{console.log(t.value),t.value>0?t.value--:a()},1e3)}function a(){e&&(clearTimeout(e),e=null)}return H(()=>{a()}),{count:t,start:s,stop:a}}const ve={key:0,class:"sms-btn countdown"},we=S({__name:"index",props:{mobile:[String,Number]},setup(e){const t=e,{count:s,start:a}=he(),o=J({smsText:"获取验证码",captchaShow:!1});function y(){if(!c(t.mobile)){C("请输入手机号");return}if(!Y(c(String(t.mobile)))){C("手机号格式错误");return}o.captchaShow=!0}function d(n){_({picCodeParams:n})}function _(n={}){const{picCodeParams:r}=n,f={mobile:c(t.mobile),key:r.requestId,picCode:r.code};V.verificationSmsGet(f).then(()=>{o.captchaShow=!1,C({message:"短信已发送，请查收",duration:2e3}),a(X.count)}).catch(l=>{console.error(l)})}return B(s,()=>{s.value>0?o.smsText=`已发送(${s.value}s)`:o.smsText="重新发送"}),(n,r)=>{const f=fe,l=p("van-field");return v(),x(l,null,{button:g(()=>[c(s)?(v(),P("span",ve,q(o.smsText),1)):(v(),P("span",{key:1,class:"sms-btn",onClick:y},q(o.smsText),1)),w(f,{show:o.captchaShow,"onUpdate:show":r[0]||(r[0]=k=>o.captchaShow=k),onConfirm:d},null,8,["show"])]),_:1})}}});const ke=I(we,[["__scopeId","data-v-181ded48"]]),ye=S({name:"PwdField",setup(){const e=h(!1);function t(){e.value=!e.value}return{eye:e,onSwitch:t}}});function be(e,t,s,a,o,y){const d=p("van-icon"),_=p("van-field");return v(),x(_,{type:e.eye?"text":"password"},{"right-icon":g(()=>[w(d,{name:e.eye?"eye-o":"closed-eye",onClick:e.onSwitch},null,8,["name","onClick"])]),_:1},8,["type"])}const Se=I(ye,[["render",be]]);export{Se as _,ke as a};
