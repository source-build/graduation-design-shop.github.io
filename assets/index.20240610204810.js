import{_ as G}from"./index.20240610204822.js";import{d as $,a as h,q as O,n as _,c as r,e as u,f,h as d,w as b,g as e,S as A,F as B,s as S,v as Y,x as E,p as D,m as M,_ as F,u as J,o as K,b as Q,i as U,j as V,l as W,k as N,t as v}from"./index.202406102048.js";import{A as z}from"./index.20240610204827.js";import{_ as X}from"./index.20240610204831.js";const Z=n=>(D("data-v-bdf2b3fe"),n=n(),M(),n),ee=Z(()=>e("div",{class:"exchange-header van-hairline--bottom"},"兑换优惠口令",-1)),te={class:"exchange-body"},se={name:"ExchangeCoupon"},oe=$({...se,props:{show:{type:Boolean}},emits:["update:show","success"],setup(n,{expose:T,emit:i}){const s=i,g={width:"80%","border-radius":"4px"},a=h(""),w=O(()=>_(a).length);function x(){if(!_(a)){S("请输入口令");return}const m={pwd:_(a)};Y({forbidClick:!0,message:"加载中...",duration:0}),z.discountsFetch(m).then(()=>{E(),S({message:"兑换成功",duration:2e3}),s("success")}).catch(l=>{console.error(l),E(),Number(l.code)===700?S({message:"口令无效",duration:2e3}):S({message:l.msg,duration:2e3})})}function y(){p(!0)}function k(){p(!1)}function p(m){s("update:show",m)}return T({open:y,close:k,updateShow:p}),(m,l)=>{const C=r("van-icon"),I=r("van-field"),c=r("van-popup"),o=X;return u(),f(B,null,[d(c,{show:n.show,position:"center",style:g,"onUpdate:show":p},{default:b(()=>[e("div",{class:"exchange-popup-close",onClick:k},[d(C,{class:"exchange-popup-close-icon",name:"cross"})]),ee,e("div",te,[d(I,{modelValue:a.value,"onUpdate:modelValue":l[0]||(l[0]=L=>a.value=L),clearable:"",border:!1,placeholder:"请输入口令（例如v-shop，2022）",class:"exchange-field",type:"text"},null,8,["modelValue"]),e("div",{class:A(["van-haptics-feedback","exchange-btn",w.value?"active":"gray"]),type:"primary",onClick:x}," 兑换 ",2)])]),_:1},8,["show"]),d(o,{size:"medium",text:"兑换优惠口令",onClickBtn:y})],64)}}});const ae=F(oe,[["__scopeId","data-v-bdf2b3fe"]]),ne=""+new URL("png/coupon.202406102048.png",import.meta.url).href,ce=n=>(D("data-v-2baed244"),n=n(),M(),n),ie={class:"container"},le={class:"tab-list"},ue={class:"list-item-hd"},de={class:"list-item-money"},pe={class:"list-item-price"},_e=ce(()=>e("span",{class:"list-item-price-unit"},"元",-1)),re={class:"list-item-desc van-ellipsis"},me={class:"list-item-bd"},ve={class:"list-item-bd-inner"},he={class:"list-item-bd-title van-ellipsis"},fe={class:"list-item-bd-txt"},be=$({__name:"index",setup(n){const T=J();K(()=>{x()});const i=h([{name:"未使用",status:0,customClass:"red",buttonTxt:"立即使用"},{name:"已使用",status:3,customClass:"gray",buttonTxt:"已使用"},{name:"已过期",status:2,customClass:"gray",buttonTxt:"已过期"}]),s=h(0),g=h([]),a=h(!0),w=Q({emptyText:"暂无优惠券",emptyImage:ne});function x(){a.value=!0,z.discountsMy({status:_(i)[_(s)].status}).then(c=>{g.value=c.data||[]}).finally(()=>{a.value=!1})}function y(c){return c.slice(0,10)}function k(c){let o="";return c===0?o="满任意金额可用":o=`满${c}元可用`,o}function p(){T.replace({path:"/home"})}function m(){_(a)||x()}function l(){p()}const C=h(!1);function I(){C.value=!1,_(s)===0&&x()}return(c,o)=>{const L=r("van-tab"),H=r("van-tabs"),P=r("van-button"),R=r("van-empty"),j=G;return u(),f("div",ie,[e("div",le,[d(H,{active:s.value,"onUpdate:active":o[0]||(o[0]=t=>s.value=t),onClickTab:m},{default:b(()=>[(u(!0),f(B,null,U(i.value,(t,q)=>(u(),V(L,{key:q,title:t.name},null,8,["title"]))),128))]),_:1},8,["active"])]),d(j,{loading:a.value,"onUpdate:loading":o[1]||(o[1]=t=>a.value=t),hasData:!!g.value.length},{empty:b(()=>[d(R,{class:"empty",image:w.emptyImage,description:w.emptyText},{default:b(()=>[s.value===0?(u(),V(P,{key:0,class:"empty-btn",round:"",plain:"",type:"primary",onClick:p},{default:b(()=>[W("进店逛逛")]),_:1})):N("",!0)]),_:1},8,["image","description"])]),default:b(()=>[e("div",{class:A(["list",[i.value[s.value]?i.value[s.value].customClass:""]])},[(u(!0),f(B,null,U(g.value,t=>(u(),f("div",{key:t.id,class:"list-item"},[e("div",ue,[e("div",de,[e("span",pe,v(t.money),1),_e]),e("div",re,v(k(t.moneyHreshold)),1)]),e("div",me,[e("div",ve,[e("div",he,v(t.name),1),e("div",fe,v(y(t.dateStart))+"至"+v(y(t.dateEnd)),1)]),s.value===0?(u(),f("div",{key:0,class:"list-item-bd-action",onClick:l},v(i.value[s.value]?i.value[s.value].buttonTxt:""),1)):N("",!0)])]))),128))],2)]),_:1},8,["loading","hasData"]),d(ae,{show:C.value,"onUpdate:show":o[2]||(o[2]=t=>C.value=t),onSuccess:I},null,8,["show"])])}}});const we=F(be,[["__scopeId","data-v-2baed244"]]);export{we as default};
